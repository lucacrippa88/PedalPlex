<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF con Watermark Solo PDF</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  #content {
    width: 500px;
    padding: 20px;
    border: 1px solid #ccc;
  }
</style>
</head>
<body>

<div id="content">
  <h1>Contenuto del Div</h1>
  <p>Questo testo sar√† incluso nel PDF con il watermark.</p>
</div>

<button id="downloadBtn">Scarica PDF</button>

<script>
document.getElementById('downloadBtn').addEventListener('click', async () => {
  const { jsPDF } = window.jspdf;
  const div = document.getElementById('content');

  // Cattura il div come canvas
  const canvas = await html2canvas(div, { scale: 2 });
  const imgData = canvas.toDataURL('image/png');

  // PDF con dimensioni uguali al canvas per rispettare proporzioni
  const pdf = new jsPDF({
    orientation: canvas.width > canvas.height ? 'landscape' : 'portrait',
    unit: 'px',
    format: [canvas.width, canvas.height]
  });

  // Aggiungi immagine del div
  pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);

  // Aggiungi watermark
  pdf.setFontSize(60);
  pdf.setTextColor(150, 150, 150); // colore grigio chiaro
  pdf.text("WATERMARK", canvas.width / 2, canvas.height / 2, {
    align: 'center',
    angle: -30
  });

  // Scarica il PDF
  pdf.save('documento.pdf');
});
</script>

</body>
</html>
